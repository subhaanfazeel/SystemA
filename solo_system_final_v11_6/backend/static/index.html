<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1">
<title>SYSTEM</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<link rel="manifest" href="/static/manifest.json">
<meta name="theme-color" content="#001a1f">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="icon" href="/static/icon-192.svg">
<link rel="apple-touch-icon" href="/static/icon-192.svg">
<link rel="stylesheet" href="/static/styles.css?v11.9">
</head>
<body>
<script>
(async function(){
  try{
    var flag = 'solo_nuked_v9';
    if(!localStorage.getItem(flag)){
      if('serviceWorker' in navigator){
        var regs = await navigator.serviceWorker.getRegistrations().catch(function(){return[]});
        for(var i=0;i<regs.length;i++){ try{ await regs[i].unregister(); }catch(e){} }
      }
      if('caches' in window){
        var keys = await caches.keys().catch(function(){return[]});
        await Promise.all(keys.map(function(k){ return caches.delete(k).catch(function(){return false}); })).catch(function(){});
      }
      localStorage.setItem(flag, '1');
      window.location.reload(true);
    }
  }catch(e){ console.warn('nuke failed', e); }
})();
</script>

<header class="header">
  <h1 class="logo glow">SYSTEM</h1>
  <div id="greet" class="sub"></div>
</header>

<main class="content" id="appRoot">
  <section id="main" class="panel"></section>
  <section id="tasks" class="panel hidden"></section>
  <section id="nonneg" class="panel hidden"></section>
  <section id="shop" class="panel hidden"></section>
  <section id="diary" class="panel hidden"></section>
  <section id="stats" class="panel hidden"></section>
  <section id="settings" class="panel hidden"></section>
</main>

<nav class="dock">
  <button data-view="main" class="dock-btn active">Home</button>
  <button data-view="tasks" class="dock-btn">Tasks</button>
  <button data-view="nonneg" class="dock-btn">Non-Negotiables</button>
  <button data-view="shop" class="dock-btn">Shop</button>
  <button data-view="diary" class="dock-btn">Diary</button>
  <button data-view="stats" class="dock-btn">Stats</button>
  <button data-view="settings" class="dock-btn">Settings</button>
</nav>

<!-- notification modal -->
<div id="notif" class="modal hidden">
  <div class="modal-card">
    <h3 id="notif-title"></h3>
    <p id="notif-body"></p>
    <div class="row mt12">
      <button class="btn" id="notif-ok" style="display:none;">Ok</button>
    </div>
  </div>
</div>

<audio id="ping" src="/static/sounds/ping.wav?v11.9"></audio>
<script src="/static/app.js?v11.9" defer></script>
<script src="/static/sw-register.js?v11.9" defer></script>

<footer style="text-align:center;color:#6feefc;margin:10px 0;font-size:12px">SYSTEM v9</footer>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const LOADER_ID = 'loading-overlay';
    const el = document.getElementById(LOADER_ID) || document.querySelector('.loader') || document.querySelector('#app-loading');
    if (el) {
      console.debug("Forcing loader removal fallback.");
      setTimeout(() => {
        el.style.transition = 'opacity 0.4s';
        el.style.opacity = '0';
        setTimeout(() => el.remove(), 500);
      }, 1500);
    } else {
      console.debug("No loader element found on DOMContentLoaded.");
    }
  });
</script>

</body>
</html>
